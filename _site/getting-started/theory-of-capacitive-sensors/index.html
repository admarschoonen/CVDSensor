<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Theory of capacitive sensors</title>
  <meta name="description" content="Some examples on how to get started and use TouchLib for (capacitive) touch sensors on Arduino and Arduino-like boards.
">

  <link rel="stylesheet" href="/TouchLib/css/main.css">
  <link rel="canonical" href="https://github.com/admarschoonen/TouchLib/TouchLib/getting-started/theory-of-capacitive-sensors/">
  <link rel="alternate" type="application/rss+xml" title="TouchLib Documentation" href="https://github.com/admarschoonen/TouchLib/TouchLib/feed.xml">
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/TouchLib/">TouchLib Documentation</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
	
        	<a class="active-book-link" href="../../getting-started/introduction/">Getting started</a>
	
	
        	<a class="book-link" href="../../touchlib-api/introduction/">TouchLib API</a>
	
      </div>

    </nav>

  </div>

</header>

    <div id="menu">
        
        <ul>
            
            
            
            
            
            
            <li><a  href="../../getting-started/introduction/">Introduction</a></li>
            
            
            
            
            
            <li><a class="active" href="../../getting-started/theory-of-capacitive-sensors/">Theory of capacitive sensors</a></li>
            
            
            
            
            
            <li><a  href="../../getting-started/making-a-capacitive-sensor/">Making a capacitive sensor</a></li>
            
            
            
            <li><a  href="../../getting-started/making-a-resistive-sensor/">Making a resistive sensor</a></li>
            
            
            
            <li><a  href="../../getting-started/tuning-a-sensor/">Tuning a sensor</a></li>
            
            
            
            <li><a  href="../../getting-started/combining-capacitive-and-resistive-sensing/">Combining capacitive and resistive sensing</a></li>
            
            
            
            <li><a  href="../../getting-started/using-touchlib-in-a-real-project/">Using TouchLib in a real project</a></li>
            
            
            
            
            
            
        </ul>
    </div>

    <div class="page-content">
      <div class="wrapper">
        <article class="post">

  <header class="post-header">
    <h1 class="post-title">Theory of capacitive sensors</h1>
  </header>

  <div class="post-content">
    <h2 id="basics">Basics</h2>
<p>Capacitive touch systems exploit the property that from an electronic circuit
point of view, human beings not much more than large bags filled with a salty
(and therefore conductive) liquid. Such objects usually have a pretty good
connection with (earth) ground, either directly (resistively) or indirectly
(capacitively).</p>

<p>Since capacitive sensors typically are used to measure how far away this ground
is, it looks like ground is coming closer when the user moves his hand closer
to the sensor, and ground is moving further away when the user removes his
hand.</p>

<p>For such systems, the hand of the user (and actually all conducting objects
with a reasonably well defined potential) act as one plate of a capacitor and
the capacitive sensor itself is the other plate. The closer these plates are,
the larger the capacitance is.</p>

<p>The sensor itself consists of a conductive surface (usually a copper pad on a
PCB) and forms one side of the capacitor.  The sensor itself has a very weak
connection to ground and thus there are only a few electrical field lines
flowing from the sensor to ground and from sensor to the user. The capacitance
measured by the sensor in this case is very low.
<img src="../../capacitive-sensor-fieldlines-untouched.png" alt="capacitive-sensor-fieldlines-untouched" /></p>

<p>When the user brings his hand or finger closer to the sensor, it looks to the
sensor as if ground is coming closer and the connection with ground becomes
stronger (more field lines flowing from sensor to user). The capacitance
measured by the sensor in this case is high.
<img src="../../capacitive-sensor-fieldlines-touched.png" alt="capacitive-sensor-fieldlines-touched" /></p>

<p>As said before, a capacitive touch sensor is in its most basic form just a
conductive surface. Almost any conductive material will work and all you have
to do is make sure that the surface is roughly the same shape and area of the
object that you use to touch it. In other words: if the sensor is meant to be
touched with a finger, make it roughly the size of your finger tip (about 1
square cm); if it is meant to be touched with a hand, make it roughly the size
of your hand (about 10 square cm).</p>

<p>Pleaes note to never touch the conductive material of the sensor directly!
While this does give you a very strong signal, many touch chips and algorithms
(including the one in TouchLib) cannot properly handle this. Furthermore, you
might damage the chip or Arduino by static discharge, especially when you are
wearing wool or synthetic clothing. Eventhough you might not see, hear or feel
a spark, it could still be there and could still be enough to damage for
example some GPIO pins or memory bits. Debugging these issues can be very time
consuming and frustrating. So, in short: always put a layer of insulation over
your sensors.</p>

<h2 id="interference-from-other-sources">Interference from other sources</h2>
<p>There are several different methods to measure the capacitance of a capacitive
sensor but most methods rely on a combination of driving the voltage on the
sensor to a known value (supply or ground), followed by leaving the sensor
floating and then:</p>
<ul>
  <li>measuring the time it takes before the voltage on the sensor reaches a
certain level, or</li>
  <li>connecting the sensor to a reference capacitor and measuring the voltage on
the sensor</li>
</ul>

<p>In both cases, the sensor is floating, which means that the voltage is easily
disturbed by external electrical fields. These fields can flow from the sensor
to ground (via the users hand for example). This is usually the desired
behaviour.</p>

<p>However, these fields can also flow to or from other sources, such as another
large metallic object that has been placed close by or electrical fields from
(for example) power supplies or from switching signals (PWM lines for LED or
motor control for example). The higher these supply or PWM voltages are and the
closer they are to the sensor (or to the wire connecting the sensor to the
measurement chip), the higher the risk of interference will be. In the figure
below, the microcontroller (Arduino) is connected to an LED and a capacitive touch
sensor. The LED and sensor are connected with long traces that run parallel. In
general this is not a good idea, as it increases the risk of interference from
the LED to the sensor.
<img src="../../capacitive-sensor-led-much-crosstalk.png" alt="capacitive-sensor-led-much-crosstalk" /></p>

<p>When desiging a system with capacitive sensors it is therefore recommended to
take into account which other sources can (capacitively) couple into the sensor
or the wire / trace that connects the sensor to the measurement chip. Ensure
that these sources are far way so that the capacitive coupling is reduced and
avoid running parallel tracks or wires which carry high voltages or switching
signals. This is shown in the figure below.
<img src="../../capacitive-sensor-led-little-crosstalk.png" alt="capacitive-sensor-led-little-crosstalk" /></p>

<p>Alternatively, you can use shielding or guards to reduce the impact of capacitive
coupling with these sources. More on that below.</p>

<h2 id="shields-and-guards">Shields and guards</h2>
<p>As we have mentioned above, the capacitive signal is easily disturbed by other
sources such as PWM signals. One way to avoid that is to increase the distance
between the sensor and the interfering source and to make sure that also the
distance between the wires from the interfering source and from the capacitive
sensor have maximum distance. An alternative to that is to place some
conductive material with a well defined potential between the interfering
signal and the sensor.</p>

<p>The most simple construction is to connect this conductive material to the
ground of your circuit. In that case, it is called a shield and this is shown
in the image below. If this material is at least 3 mm wide (but even wider is
better), many of the electrical field lines from the trace to the LED will
terminate on the shield and not flow to the trace of the capacitive sensor. One
drawback of this however, is that it adds a parasitic capacitance between the
trace of the touch sensor and the shield. This can result in a reduced
sensitivity of the sensor, but usually this loss of sensitivity well out weighs
the problems caused by interference from other signals. Furthermore, this
parasitic capacitance can be reduced by increasing the spacing between the
shield and the sensor wire. Also, it can be further reduced by placing the
guard on only one side of the sensor wire (only place it between the sensor
wire and the LED wire).</p>

<p>If the trace leading up to the sensor is not a trace on a printed circuit board
but a normal wire, you might consider using a coaxial cable instead. The inside
of the coaxial cable is the wire that connects the sensor to the measurement
chip and the outside should be connected to ground to work as a shield.</p>

<p><img src="../../capacitive-sensor-led-gnd.png" alt="capacitive-sensor-led-gnd" /></p>

<p>Another method to reduce interference without significantly increasing the
parasitic capacitance is by connecting the conductive material not to ground
but to the output of an opamp. The negative input of the opamp should also be
connected to this material (so the opamp provides 1x gain) and the positive
input should be connected to the touch sensor. In this configuration, the
voltage on the conductive material will always have the same as on the sensor
itself.  However, since the opamp is capable of supplying much more current
than the sensor (it is a low impedance source), the voltage on the conductive
material is not as easily disturbed as the voltage on the touch sensor. The
width of the material should again be at lease 3 mm, just like in the case of a
shield.</p>

<p>The main advantage of this setup is however, that because the voltage on the
guard is always the same as on the sensor, the parasitic capacitance between
the sensor wire and the guard is virtually short-circuited. The net effect of
that is that the sensor does not see this parasitic capacitance any more.</p>

<p><img src="../../capacitive-sensor-led-guard.png" alt="capacitive-sensor-led-guard" /></p>

<p>Similar to the shield, it is possible to use a coaxial cable here as well.
Again, the inside of the cable connects the wire to the measurement chip (and
to the positive input of the opamp) and the outside connects to the output (and
the negative input) of the opamp and works as guard.</p>

<p>Note that it is not possible to share opamps between sensors. You will need as
many opamps as you have sensors if you want to use a guard on all of them.
Also, if you have 2 touch sensors, you will need 2 guards between the traces
leading to the sensors as shown below.</p>

<p><img src="../../capacitive-sensor-led-guard-2x.png" alt="capacitive-sensor-led-guard-2x" /></p>

<h2 id="making-a-sensor-sensitive-to-only-one-side">Making a sensor sensitive to only one side</h2>
<p>In addition to reducing interference from nearby sources, you can also use
shields and guards to make a sensor sensitive to only one side. In that case,
you not only have to run the shield or guard next to the traces of the sensor,
but also underneath the sensor. Make sure the guard extends the sensor by at
least 3 mm on all sides. This will prevent electrical field lines coming from
that side to terminate on the sensor and is a very effective way to use a touch
sensor in wearables or clothing, as it can ignore the human body on the inside
and still respond to touches of hands and fingers on the outside. Also, make
sure that there is some insulating material underneath the sensor since you
don’t want to accidentally touch the guard. Opamps can deliver more current
than the sensor itself can, but it is stil too weak to withstand the
short circuit to ground that occurs when you directy touch the guard.</p>


  </div>

</article>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">TouchLib Documentation</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li>TouchLib Documentation</li>
          <li><a href="mailto:admar@familieschoonen.nl">admar@familieschoonen.nl</a></li>
        </ul>
      </div>

      <div class="footer-col footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/admarschoonen"><span class="icon icon--github"><svg viewBox="0 0 16 16"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span><span class="username">admarschoonen</span></a>

          </li>
          

          
        </ul>
      </div>

      <div class="footer-col footer-col-3">
        <p>Some examples on how to get started and use TouchLib for (capacitive) touch sensors on Arduino and Arduino-like boards.
</p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
